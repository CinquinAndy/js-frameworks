# React - Next.js et les Meta-Frameworks

Une fois que tu maÃ®trises **un peu** React, je te **CONSEILLE FORTEMENT** de passer sur un **meta-framework**. Next.js, Astro, Remix... peu importe lequel, Ã§a va **rÃ©volutionner** ta faÃ§on de dÃ©velopper !

---

## Pourquoi des Meta-Frameworks ?

### React seul, c'est limitÃ©

React, c'est juste une **librairie** pour crÃ©er des interfaces. Mais pour une **vraie** application web, il te faut :

- ğŸ—ºï¸ **Routing** : gÃ©rer les pages et navigation
- âš¡ **Server-Side Rendering (SSR)** : SEO et performance
- ğŸ—ï¸ **Static Site Generation (SSG)** : sites ultra rapides
- ğŸ–¼ï¸ **Optimisation d'images** : formats modernes, lazy loading
- ğŸ“¦ **Bundle optimization** : code splitting automatique
- ğŸ”§ **Configuration** : Webpack, Babel, TypeScript...

### React + Vite = Pas assez pour la prod

```jsx
// âŒ Avec React/Vite classique - tu dois tout faire Ã  la main
function App() {
  return (
    <div>
      {/* Comment tu fais du routing ? */}
      {/* Comment tu optimises les images ? */}
      {/* Comment tu gÃ¨res le SEO ? */}
      {/* Comment tu fais du SSR ? */}
    </div>
  )
}
```

### Next.js = React sur stÃ©roÃ¯des ! ğŸ’ª

```jsx
// âœ… Avec Next.js - tout est automatique !
export default function HomePage() {
  return (
    <div>
      <Head>
        <title>Ma super page - SEO automatique !</title>
      </Head>
      <Image 
        src="/photo.jpg" 
        alt="Photo optimisÃ©e automatiquement"
        width={500}
        height={300}
      />
    </div>
  )
}

// SSG automatique avec cette fonction
export async function getStaticProps() {
  const data = await fetch('https://api.example.com/data')
  return { props: { data } }
}
```

---

## Next.js - Le Boss des Meta-Frameworks

### Setup ultra simple

```bash
npx create-next-app@latest mon-app-nextjs
cd mon-app-nextjs
npm run dev
```

**Boom !** Ton app Next.js tourne sur `http://localhost:3000`

### Structure du projet

```
mon-app-nextjs/
â”œâ”€â”€ app/                 # ğŸ†• App Router (Next.js 13+)
â”‚   â”œâ”€â”€ layout.tsx       # Layout global
â”‚   â”œâ”€â”€ page.tsx         # Page d'accueil
â”‚   â”œâ”€â”€ about/
â”‚   â”‚   â””â”€â”€ page.tsx     # Route /about
â”‚   â””â”€â”€ blog/
â”‚       â”œâ”€â”€ page.tsx     # Route /blog
â”‚       â””â”€â”€ [id]/
â”‚           â””â”€â”€ page.tsx # Route dynamique /blog/123
â”œâ”€â”€ public/              # Fichiers statiques
â”œâ”€â”€ components/          # Tes composants
â””â”€â”€ next.config.js       # Configuration Next.js
```

---

## Les Super-Pouvoirs de Next.js

### 1. App Router - Routing Moderne

```jsx
// app/page.tsx - Page d'accueil
export default function HomePage() {
  return <h1>Accueil</h1>
}

// app/about/page.tsx - Page /about
export default function AboutPage() {
  return <h1>Ã€ propos</h1>
}

// app/blog/[id]/page.tsx - Route dynamique
export default function BlogPost({ params }) {
  return <h1>Article {params.id}</h1>
}

// app/layout.tsx - Layout global
export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <nav>
          <Link href="/">Accueil</Link>
          <Link href="/about">Ã€ propos</Link>
        </nav>
        {children}
      </body>
    </html>
  )
}
```

### 2. Server Components - Performance de malade

```jsx
// âœ… Server Component - s'execute sur le serveur
async function ProductsList() {
  // Cette requÃªte se fait cÃ´tÃ© serveur !
  const products = await fetch('https://api.example.com/products')
  
  return (
    <div>
      {products.map(product => (
        <ProductCard key={product.id} product={product} />
      ))}
    </div>
  )
}

// âœ… Client Component - pour l'interactivitÃ©
'use client'
import { useState } from 'react'

function ProductCard({ product }) {
  const [liked, setLiked] = useState(false)
  
  return (
    <div>
      <h3>{product.name}</h3>
      <button onClick={() => setLiked(!liked)}>
        {liked ? 'â¤ï¸' : 'ğŸ¤'}
      </button>
    </div>
  )
}
```

### 3. Static Site Generation (SSG)

```jsx
// app/blog/[id]/page.tsx
export default function BlogPost({ params }) {
  return <h1>Article {params.id}</h1>
}

// GÃ©nÃ¨re toutes les pages statiquement au build
export async function generateStaticParams() {
  const posts = await fetch('https://api.example.com/posts')
  
  return posts.map(post => ({
    id: post.id.toString()
  }))
}
```

### 4. Server Actions - Full-stack sans API

```jsx
// actions.ts
'use server'

export async function createPost(formData) {
  const title = formData.get('title')
  const content = formData.get('content')
  
  // Sauvegarde en base directement !
  await db.posts.create({ title, content })
  
  redirect('/blog')
}

// components/CreatePost.tsx
import { createPost } from './actions'

export default function CreatePost() {
  return (
    <form action={createPost}>
      <input name="title" placeholder="Titre" />
      <textarea name="content" placeholder="Contenu" />
      <button type="submit">Publier</button>
    </form>
  )
}
```

### 5. Optimisations Automatiques

```jsx
import Image from 'next/image'
import Link from 'next/link'

export default function HomePage() {
  return (
    <div>
      {/* Image optimisÃ©e automatiquement */}
      <Image
        src="/hero.jpg"
        alt="Hero"
        width={800}
        height={400}
        priority // Charge en prioritÃ©
      />
      
      {/* Prefetch automatique des liens */}
      <Link href="/about">Ã€ propos</Link>
      
      {/* Code splitting automatique */}
      <DynamicComponent />
    </div>
  )
}
```

---

## Exemples Pratiques

### Blog avec SSG

```jsx
// app/blog/page.tsx - Liste des articles
export default async function BlogPage() {
  const posts = await fetch('https://api.example.com/posts')
  
  return (
    <div>
      <h1>Mon Blog</h1>
      {posts.map(post => (
        <article key={post.id}>
          <h2>
            <Link href={`/blog/${post.id}`}>
              {post.title}
            </Link>
          </h2>
          <p>{post.excerpt}</p>
        </article>
      ))}
    </div>
  )
}

// app/blog/[id]/page.tsx - Article individuel
export default async function BlogPost({ params }) {
  const post = await fetch(`https://api.example.com/posts/${params.id}`)
  
  return (
    <article>
      <h1>{post.title}</h1>
      <div dangerouslySetInnerHTML={{ __html: post.content }} />
    </article>
  )
}

// GÃ©nÃ©ration statique de tous les articles
export async function generateStaticParams() {
  const posts = await fetch('https://api.example.com/posts')
  return posts.map(post => ({ id: post.id.toString() }))
}
```

### E-commerce avec Server Actions

```jsx
// app/products/[id]/page.tsx
import { addToCart } from './actions'

export default async function ProductPage({ params }) {
  const product = await fetch(`/api/products/${params.id}`)
  
  return (
    <div>
      <h1>{product.name}</h1>
      <p>Prix: {product.price}â‚¬</p>
      
      <form action={addToCart}>
        <input type="hidden" name="productId" value={product.id} />
        <input type="number" name="quantity" defaultValue={1} />
        <button type="submit">Ajouter au panier</button>
      </form>
    </div>
  )
}

// actions.ts
'use server'
import { cookies } from 'next/headers'

export async function addToCart(formData) {
  const productId = formData.get('productId')
  const quantity = formData.get('quantity')
  
  // RÃ©cupÃ¨re le panier depuis les cookies
  const cart = cookies().get('cart')?.value || '[]'
  const cartItems = JSON.parse(cart)
  
  // Ajoute le produit
  cartItems.push({ productId, quantity: parseInt(quantity) })
  
  // Sauvegarde dans les cookies
  cookies().set('cart', JSON.stringify(cartItems))
  
  redirect('/cart')
}
```

---

## Configuration AvancÃ©e

### next.config.js

```js
/** @type {import('next').NextConfig} */
const nextConfig = {
  // Optimisations d'images
  images: {
    domains: ['example.com', 'cdn.example.com'],
    formats: ['image/webp', 'image/avif'],
  },
  
  // Variables d'environnement
  env: {
    CUSTOM_KEY: process.env.CUSTOM_KEY,
  },
  
  // Redirections
  async redirects() {
    return [
      {
        source: '/old-page',
        destination: '/new-page',
        permanent: true,
      },
    ]
  },
  
  // Headers de sÃ©curitÃ©
  async headers() {
    return [
      {
        source: '/(.*)',
        headers: [
          {
            key: 'X-Frame-Options',
            value: 'DENY',
          },
        ],
      },
    ]
  },
}

module.exports = nextConfig
```

### Middleware pour l'auth

```jsx
// middleware.ts
import { NextResponse } from 'next/server'

export function middleware(request) {
  // VÃ©rifie l'auth pour les pages protÃ©gÃ©es
  if (request.nextUrl.pathname.startsWith('/dashboard')) {
    const token = request.cookies.get('auth-token')
    
    if (!token) {
      return NextResponse.redirect(new URL('/login', request.url))
    }
  }
}

export const config = {
  matcher: '/dashboard/:path*',
}
```

---

## Les Alternatives Ã  Next.js

### ğŸš€ Astro - Le minimaliste

```jsx
// Parfait pour les sites avec peu d'interactivitÃ©
---
const posts = await fetch('https://api.example.com/posts').then(r => r.json())
---

<html>
<head>
  <title>Mon site Astro</title>
</head>
<body>
  <h1>Blog</h1>
  {posts.map(post => (
    <article>
      <h2>{post.title}</h2>
      <p>{post.excerpt}</p>
    </article>
  ))}
</body>
</html>
```

### ğŸµ Remix - Le full-stack

```jsx
// Remix mise tout sur les Web Standards
export async function loader({ params }) {
  return json(await getPost(params.id))
}

export async function action({ request }) {
  const formData = await request.formData()
  await createPost(formData)
  return redirect('/posts')
}

export default function Post() {
  const post = useLoaderData()
  
  return (
    <div>
      <h1>{post.title}</h1>
      <Form method="post">
        <input name="comment" />
        <button type="submit">Commenter</button>
      </Form>
    </div>
  )
}
```

### âš¡ Vite + React Router - DIY

```jsx
// Si tu veux tout contrÃ´ler toi-mÃªme
import { BrowserRouter, Routes, Route } from 'react-router-dom'

function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
        <Route path="/blog/:id" element={<BlogPost />} />
      </Routes>
    </BrowserRouter>
  )
}
```

---

## DÃ©ployement

### Vercel (CrÃ©ateurs de Next.js)

```bash
npm i -g vercel
vercel --prod
```

**Et voilÃ  !** Ton app est en ligne avec HTTPS, CDN, edge functions...

### Alternatives

- **Netlify** : Simple et efficace
- **Railway** : Full-stack avec base de donnÃ©es
- **AWS Amplify** : Ã‰cosystÃ¨me AWS complet
- **Self-hosted** : Docker + votre serveur

---

## Points ClÃ©s Ã  Retenir

1. **Next.js** = React + tout ce qu'il faut pour la prod
2. **App Router** = systÃ¨me de routing moderne et puissant
3. **Server Components** = performance et SEO automatiques
4. **Server Actions** = full-stack sans API sÃ©parÃ©e
5. **SSG/SSR** = flexibilitÃ© totale pour chaque page
6. **Optimisations** = images, bundles, prefetch automatiques
7. **DÃ©ployement** = un clic avec Vercel

---

## Mon Conseil Personnel

**Commence TOUJOURS par Next.js** si tu veux faire du React sÃ©rieusement.

Pourquoi ?
- âœ… **MarchÃ© du travail** : 90% des jobs demandent Next.js
- âœ… **ProductivitÃ©** : tu vas 10x plus vite
- âœ… **Ã‰volutivitÃ©** : du site vitrine au SaaS complexe
- âœ… **CommunautÃ©** : Ã©norme, docs parfaites
- âœ… **Future-proof** : technologies d'avant-garde

Les autres meta-frameworks ?
- **Astro** = si ton site est quasi-statique
- **Remix** = si tu veux du full-stack pur
- **React/Vite** = si tu dÃ©butes ou expÃ©rimentes

---

## Ressources Pour Aller Plus Loin

- ğŸ“š [Next.js Documentation](https://nextjs.org/docs)
- ğŸ“ [Next.js Learn Course](https://nextjs.org/learn)
- ğŸ¥ [Next.js en 100 secondes](https://www.youtube.com/watch?v=Sklc_fQBmcs)
- ğŸ“– [Next.js Handbook](https://nextjs.org/handbook)
- ğŸ†š [Next.js vs Remix vs Astro](https://blog.logrocket.com/nextjs-vs-remix-vs-astro/)

---

**Prochaine Ã©tape :** On va voir comment crÃ©er des **formulaires robustes** avec Next.js et React Hook Form dans `15.0.10-Forms.md` ! ğŸ“‹
