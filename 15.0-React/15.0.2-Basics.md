# React - Les Bases Essentielles

Maintenant qu'on a vu comment setup un projet React avec Vite, on va creuser les **concepts fondamentaux** de React !

---

## Les Composants React - Deep Dive

### Qu'est-ce qu'un Composant Fonctionnel ?

Un **composant fonctionnel** est simplement une **fonction JavaScript** qui retourne du JSX. C'est le type de composant le plus courant et **recommand√©** en React moderne.

> **D√©finition :** Un composant React est "une fonction JavaScript que tu peux saupoudrer de markup" !

### Composants Fonctionnels vs Class Components

```jsx
// ‚úÖ Composant Fonctionnel (RECOMMAND√â)
function MonComposant() {
  return <h1>Hello World!</h1>
}

// ‚ùå Class Component (DEPRECATED)
class MonComposant extends React.Component {
  render() {
    return <h1>Hello World!</h1>
  }
}
```

**Pourquoi les composants fonctionnels ?**
- Plus simples √† √©crire et comprendre
- Moins de code boilerplate
- Hooks pour g√©rer state et effets de bord
- Performance optimis√©e
- Recommandation officielle React

### Syntaxes possibles

```jsx
// Function declaration
function MonComposant() {
  return <h1>Hello World!</h1>
}

// Arrow function
const MonComposant = () => {
  return <h1>Hello World!</h1>
}

// Arrow function raccourcie (sans return explicite)
const MonComposant = () => <h1>Hello World!</h1>

// Avec destructuring des props
const MonComposant = ({ title, subtitle }) => (
  <div>
    <h1>{title}</h1>
    <p>{subtitle}</p>
  </div>
)
```

### Composants avec ou sans param√®tres

```jsx
// Sans param√®tres (props)
function Header() {
  return (
    <header>
      <h1>Mon Super Site</h1>
      <nav>Navigation</nav>
    </header>
  )
}

// Avec param√®tres (props)
function UserCard({ name, email, avatar, isOnline }) {
  return (
    <div className="user-card">
      <img src={avatar} alt={`Avatar de ${name}`} />
      <div>
        <h3>{name}</h3>
        <p>{email}</p>
        <span className={isOnline ? 'online' : 'offline'}>
          {isOnline ? 'üü¢ En ligne' : 'üî¥ Hors ligne'}
        </span>
      </div>
    </div>
  )
}

// Utilisation
function App() {
  return (
    <div>
      <Header />
      <UserCard
        name="Andy"
        email="andy@example.com"
        avatar="/avatar.jpg"
        isOnline={true}
      />
    </div>
  )
}
```

### Convention de nommage

- **PascalCase** obligatoire : `MonComposant`, `TodoList`, `UserProfile`
- Les composants commencent **toujours** par une majuscule
- React fait la diff√©rence entre √©l√©ments HTML (`<div>`) et composants (`<MonComposant>`)

### Export/Import des composants

```jsx
// TodoItem.jsx
function TodoItem({ todo, onDelete }) {
  return (
    <li>
      {todo.text}
      <button onClick={() => onDelete(todo.id)}>üóëÔ∏è</button>
    </li>
  )
}

export default TodoItem

// Dans App.jsx
import TodoItem from './TodoItem'
```

---

## JSX - HTML Superpuissant

### Les r√®gles importantes

1. **Un seul √©l√©ment parent** (ou Fragment)
2. **Fermer toutes les balises** (`<br />`, `<img />`)
3. **className** au lieu de class
4. **Accolades {}** pour le JavaScript

### Exemples pratiques

```jsx
function ExemplesJSX() {
  const nom = "Andy"
  const age = 25
  const isAdult = age >= 18

  return (
    <>
      {/* Fragment pour √©viter un div inutile */}
      <h1>Profil de {nom}</h1>

      {/* Conditions dans JSX */}
      {isAdult ? (
        <p>Tu es majeur ‚úÖ</p>
      ) : (
        <p>Tu es mineur ‚ùå</p>
      )}

      {/* Rendu conditionnel avec && */}
      {age >= 21 && <p>Tu peux boire aux √âtats-Unis üç∫</p>}

      {/* Styles inline (objet JS) */}
      <div style={{
        backgroundColor: 'lightblue',
        padding: '20px',
        borderRadius: '8px'
      }}>
        Contenu styl√©
      </div>
    </>
  )
}
```

### √âchapper le JSX

```jsx
function DangerousHTML() {
  const htmlString = "<strong>HTML brut</strong>"

  return (
    <div
      dangerouslySetInnerHTML={{ __html: htmlString }}
    />
  )
}
```

‚ö†Ô∏è **Attention** : n'utilisez jamais `dangerouslySetInnerHTML` avec des donn√©es utilisateur !

---

## State Management avec useState

### useState - Les bases

```jsx
import { useState } from 'react'

function CompteurAvance() {
  const [count, setCount] = useState(0)
  const [step, setStep] = useState(1)

  const increment = () => setCount(count + step)
  const decrement = () => setCount(count - step)
  const reset = () => setCount(0)

  return (
    <div>
      <h2>Compteur: {count}</h2>
      <div>
        <label>
          Pas:
          <input
            type="number"
            value={step}
            onChange={(e) => setStep(Number(e.target.value))}
          />
        </label>
      </div>
      <button onClick={increment}>+{step}</button>
      <button onClick={decrement}>-{step}</button>
      <button onClick={reset}>Reset</button>
    </div>
  )
}
```

### √âtat avec des objets

```jsx
function FormulaireUtilisateur() {
  const [user, setUser] = useState({
    nom: '',
    email: '',
    age: 0
  })

  const handleChange = (field, value) => {
    setUser({
      ...user,  // Spread operator pour garder les autres propri√©t√©s
      [field]: value
    })
  }

  return (
    <form>
      <input
        placeholder="Nom"
        value={user.nom}
        onChange={(e) => handleChange('nom', e.target.value)}
      />
      <input
        placeholder="Email"
        value={user.email}
        onChange={(e) => handleChange('email', e.target.value)}
      />
      <input
        type="number"
        placeholder="√Çge"
        value={user.age}
        onChange={(e) => handleChange('age', Number(e.target.value))}
      />
      <pre>{JSON.stringify(user, null, 2)}</pre>
    </form>
  )
}
```

### √âtat avec des tableaux

```jsx
function ListeCourses() {
  const [items, setItems] = useState([])
  const [inputValue, setInputValue] = useState('')

  const ajouterItem = () => {
    if (inputValue.trim()) {
      setItems([
        ...items,
        { id: Date.now(), nom: inputValue, achete: false }
      ])
      setInputValue('')
    }
  }

  const toggleItem = (id) => {
    setItems(items.map(item =>
      item.id === id
        ? { ...item, achete: !item.achete }
        : item
    ))
  }

  const supprimerItem = (id) => {
    setItems(items.filter(item => item.id !== id))
  }

  return (
    <div>
      <h3>Liste de courses</h3>
      <div>
        <input
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          placeholder="Ajouter un article..."
        />
        <button onClick={ajouterItem}>Ajouter</button>
      </div>
      <ul>
        {items.map(item => (
          <li key={item.id}>
            <span
              style={{
                textDecoration: item.achete ? 'line-through' : 'none',
                cursor: 'pointer'
              }}
              onClick={() => toggleItem(item.id)}
            >
              {item.nom}
            </span>
            <button onClick={() => supprimerItem(item.id)}>üóëÔ∏è</button>
          </li>
        ))}
      </ul>
    </div>
  )
}
```

---

## Props - Communication entre composants

### Props simples

```jsx
function Carte({ titre, contenu, auteur }) {
  return (
    <div className="carte">
      <h3>{titre}</h3>
      <p>{contenu}</p>
      <small>Par {auteur}</small>
    </div>
  )
}

function App() {
  return (
    <div>
      <Carte
        titre="Mon premier article"
        contenu="Voici le contenu de l'article..."
        auteur="Andy"
      />
    </div>
  )
}
```

### Props avec des fonctions (callbacks)

```jsx
function BoutonPersonnalise({ children, couleur, onClick }) {
  return (
    <button
      style={{ backgroundColor: couleur }}
      onClick={onClick}
    >
      {children}
    </button>
  )
}

function App() {
  const handleClick = () => {
    alert('Bouton cliqu√©!')
  }

  return (
    <div>
      <BoutonPersonnalise couleur="red" onClick={handleClick}>
        Clique-moi!
      </BoutonPersonnalise>
    </div>
  )
}
```

### Props par d√©faut

```jsx
function Avatar({ nom, taille = 50, forme = 'rond' }) {
  const style = {
    width: taille,
    height: taille,
    borderRadius: forme === 'rond' ? '50%' : '0'
  }

  return (
    <div style={style}>
      {nom.charAt(0).toUpperCase()}
    </div>
  )
}

// Utilisation
<Avatar nom="Andy" />  {/* taille=50, forme="rond" */}
<Avatar nom="Marie" taille={80} forme="carr√©" />
```

---

## Rendu de listes

### Map avec cl√©s uniques

```jsx
function ListeUtilisateurs() {
  const users = [
    { id: 1, nom: 'Andy', role: 'Dev' },
    { id: 2, nom: 'Marie', role: 'Designer' },
    { id: 3, nom: 'Paul', role: 'Product Manager' }
  ]

  return (
    <ul>
      {users.map(user => (
        <li key={user.id}>
          <strong>{user.nom}</strong> - {user.role}
        </li>
      ))}
    </ul>
  )
}
```

### Filtrer et mapper

```jsx
function ListeProduits() {
  const [filtreCategorie, setFiltreCategorie] = useState('tous')

  const produits = [
    { id: 1, nom: 'iPhone', categorie: 'electronique', prix: 999 },
    { id: 2, nom: 'T-shirt', categorie: 'vetement', prix: 25 },
    { id: 3, nom: 'MacBook', categorie: 'electronique', prix: 1999 }
  ]

  const produitsFiltres = filtreCategorie === 'tous'
    ? produits
    : produits.filter(p => p.categorie === filtreCategorie)

  return (
    <div>
      <select
        value={filtreCategorie}
        onChange={(e) => setFiltreCategorie(e.target.value)}
      >
        <option value="tous">Tous</option>
        <option value="electronique">√âlectronique</option>
        <option value="vetement">V√™tement</option>
      </select>

      <div>
        {produitsFiltres.map(produit => (
          <div key={produit.id} className="produit">
            <h4>{produit.nom}</h4>
            <p>Cat√©gorie: {produit.categorie}</p>
            <p>Prix: {produit.prix}‚Ç¨</p>
          </div>
        ))}
      </div>
    </div>
  )
}
```

---

## Gestion des √©v√©nements

### √âv√©nements de base

```jsx
function GestionEvenements() {
  const [message, setMessage] = useState('')

  const handleSubmit = (e) => {
    e.preventDefault()  // Emp√™che le rechargement de la page
    console.log('Formulaire soumis:', message)
  }

  const handleKeyDown = (e) => {
    if (e.key === 'Enter' && e.ctrlKey) {
      handleSubmit(e)
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <textarea
        value={message}
        onChange={(e) => setMessage(e.target.value)}
        onKeyDown={handleKeyDown}
        placeholder="Tapez votre message... (Ctrl+Enter pour envoyer)"
      />
      <button type="submit">Envoyer</button>
    </form>
  )
}
```

### √âv√©nements personnalis√©s

```jsx
function ComposantEnfant({ onCustomEvent }) {
  const triggerCustomEvent = () => {
    onCustomEvent({
      type: 'ACTION_SPECIALE',
      data: { timestamp: Date.now() }
    })
  }

  return (
    <button onClick={triggerCustomEvent}>
      D√©clencher √©v√©nement custom
    </button>
  )
}

function ComposantParent() {
  const handleCustomEvent = (eventData) => {
    console.log('√âv√©nement re√ßu:', eventData)
  }

  return (
    <ComposantEnfant onCustomEvent={handleCustomEvent} />
  )
}
```

---

## Rendu conditionnel avanc√©

### Plusieurs conditions

```jsx
function StatusUtilisateur({ user }) {
  if (!user) {
    return <div>Chargement...</div>
  }

  if (user.banned) {
    return <div className="error">Utilisateur banni</div>
  }

  if (!user.verified) {
    return (
      <div className="warning">
        Veuillez v√©rifier votre email
      </div>
    )
  }

  return (
    <div className="success">
      Bienvenue, {user.name}!
    </div>
  )
}
```

### Switch case avec JSX

```jsx
function NotificationBadge({ type, message }) {
  const renderIcon = () => {
    switch (type) {
      case 'success':
        return '‚úÖ'
      case 'error':
        return '‚ùå'
      case 'warning':
        return '‚ö†Ô∏è'
      case 'info':
        return '‚ÑπÔ∏è'
      default:
        return 'üì¢'
    }
  }

  return (
    <div className={`notification ${type}`}>
      <span className="icon">{renderIcon()}</span>
      <span className="message">{message}</span>
    </div>
  )
}
```

---

## Exercices Pratiques

### Exercice 1: Calculatrice Simple

Cr√©ez une calculatrice qui peut faire les 4 op√©rations de base.

```jsx
function Calculatrice() {
  const [nombre1, setNombre1] = useState(0)
  const [nombre2, setNombre2] = useState(0)
  const [operation, setOperation] = useState('+')

  const calculer = () => {
    switch (operation) {
      case '+': return nombre1 + nombre2
      case '-': return nombre1 - nombre2
      case '*': return nombre1 * nombre2
      case '/': return nombre2 !== 0 ? nombre1 / nombre2 : 'Erreur'
      default: return 0
    }
  }

  return (
    <div>
      <h3>Calculatrice</h3>
      <input
        type="number"
        value={nombre1}
        onChange={(e) => setNombre1(Number(e.target.value))}
      />
      <select
        value={operation}
        onChange={(e) => setOperation(e.target.value)}
      >
        <option value="+">+</option>
        <option value="-">-</option>
        <option value="*">√ó</option>
        <option value="/">√∑</option>
      </select>
      <input
        type="number"
        value={nombre2}
        onChange={(e) => setNombre2(Number(e.target.value))}
      />
      <p>R√©sultat: {calculer()}</p>
    </div>
  )
}
```

### Exercice 2: Gestionnaire de t√¢ches avec cat√©gories

Cr√©ez un gestionnaire de t√¢ches o√π on peut :
- Ajouter des t√¢ches avec une cat√©gorie
- Filtrer par cat√©gorie
- Marquer comme termin√©
- Supprimer

---

## Points cl√©s √† retenir

1. **Composants** = fonctions qui retournent du JSX
2. **Props** = donn√©es pass√©es du parent vers l'enfant
3. **State** = donn√©es internes qui peuvent changer
4. **JSX** = HTML + JavaScript avec ses propres r√®gles
5. **√âv√©nements** = interactions utilisateur
6. **map()** = pour rendre des listes
7. **Cl√©s uniques** = performance et bugs √©vit√©s

---

## Ressources

- üìö [Thinking in React](https://react.dev/learn/thinking-in-react)
- üîß [Types de composants React](https://www.robinwieruch.de/react-component-types/)
- ‚öõÔ∏è [React Elements vs Components](https://www.robinwieruch.de/react-element-component/)

**Prochaine √©tape :** Les hooks avanc√©s et le cycle de vie dans `15.0.4-Hooks.md` !